<script type="text/javascript">
    RED.nodes.registerType('yamcsconfig',{
        category: 'config',
        defaults: {
            name: {value:""},
            ip: {value:"", required: true},
            port: {value:8090, validate:RED.validators.number()},
            instances: {value:"default"}
        },
        credentials: {
            username: {type:"text"},
            password: {type:"password"}
        },
        label: function() {
            return this.name || "YAMCS Server";
        }
    });
</script>

<script type="text/x-red" data-template-name="yamcsconfig">
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-config-input-ip"><i class="fa fa-globe"></i> Server</label>
        <input class="input-append-left" type="text" id="node-config-input-ip" placeholder="IP Address" style="width: 40%;" >
        <label for="node-config-input-port" style="margin-left: 10px; width: 35px; "> Port</label>
        <input type="text" id="node-config-input-port" placeholder="Port" style="width:45px">
    </div>
    <div class="form-row">
        <label for="node-config-input-instance"><i class="fa fa-list"></i> Instance</label>
        <input type="text" id="node-config-input-instance" placeholder="Instance Name">
    </div>
    <div class="form-row">
        <label for="node-config-input-username"><i class="fa fa-user"></i> Username</label>
        <input type="text" id="node-config-input-username" placeholder="Username">
    </div>
    <div class="form-row">
        <label for="node-config-input-password"><i class="fa fa-lock"></i> Password</label>
        <input type="password" id="node-config-input-password" placeholder="Password">
    </div>
</script>

<script type="text/x-red" data-help-name="yamcsconfig">
    <p>Shared configuration for the YAMCS servers</p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('YAMCS',{
        category: 'output',
        color: '#C0DEED',
        defaults: {
            name: {value:""},
            server: {type:"yamcsconfig", required: true },
            command: {value:1, required: true },
        },
        inputs:1,
        outputs:1,
        icon: "bridge.png",
        label: function() {
            if(this.name)
            {
                return this.name;
            }
            switch(this.command.toString()){
                case '1':
                    return 'YAMCS: getInstances';
                default:
                    return 'YAMCS';
            }
        }
    });
</script>

<script type="text/x-red" data-template-name="YAMCS">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

	<div class="form-row">
        <label for="node-input-server"><i class="fa fa-server"></i> Server</label>
        <input type="text" id="node-input-server" placeholder="">
    </div>

	<div class="form-row">
        <label for="node-input-command"><i class="fa fa-dot-circle-o"></i> Command</label>
        <select id="node-input-command">
           <option value="1">GetInstances</option>
           <option value="2">GetParameter</option>
        </select>
    </div>

    <script>
        $('#node-input-command').on('change', function() {
            console.log("Selected " + this.value);
        });  
    </script>
</script>

<script type="text/x-red" data-help-name="YAMCS">
    <p>Connects to a YAMCS server and query/control the YAMCS API.</p>
    <p><code>msg.payload.command</code> is used to override the command selected in the node.<br> Example how to send a command from a function Node<br> <code>msg.payload = { command: "getInstances"};</code></p>
    <p>Available Commands:</p>
    <ul>
            <li><code>GetInstances</code> : Site stats</li>
    </ul>
    <p>Special Commands: (No GUI)</p>
	<p>Returns all data in JSON parsable strings/objects</p>
    <p>For more information see the <a href="https://github.com/mbenson1/node-red-contrib-yamcs" target="_blank">GitHub</a> site.</p>
    <p>Version 0.2.0</p>
</script>
